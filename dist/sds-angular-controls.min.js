/*! sds-angular-controls - v0.0.1 - 2014-12-18
* https://github.com/SMARTDATASYSTEMSLLC/sds-angular-controls
* Copyright (c) 2014 Steve Gentile, David Benson; Licensed  */
angular.module("sds-angular-controls",["ui.bootstrap","toggle-switch","ngSanitize"]),function(){"use strict";function a(a,b){return void 0===$.fn.modal&&($.fn.modal=function(b){var c=this;if("hide"===b)return void(this.data("bs.modal")&&(this.data("bs.modal").close(),$(c).remove()));if("show"!==b){var d=a.open({template:$(this).find(".modal-content").html()});this.data("bs.modal",d),setTimeout(function(){$(".modal.ng-isolate-scope").remove(),$(c).css({opacity:1,display:"block"}).addClass("in")},100)}}),b.bootbox}a.$inject=["$modal","$window"],angular.module("sds-angular-controls").factory("$bootbox",a)}(),function(){"use strict";function a(){return function(a){return a.toLowerCase().replace(/ (\w)/g,function(a,b){return b.toUpperCase()})}}angular.module("sds-angular-controls").filter("camelCase",a)}(),function(){"use strict";function a(a,b){return{restrict:"E",replace:!0,transclude:!0,scope:{cols:"=",data:"=",label:"@",hideAdvanced:"@",className:"@",pageSize:"@"},templateUrl:"sds-angular-controls/client-grid.html",link:function(c,d){function e(a){c.vm.sort===a?c.vm.sortAsc=!c.vm.sortAsc:c.vm.sort=a}function f(){console.log("enter"),1===c.vm.resultCount.length&&b(function(){d.find("tbody tr a:first").click()})}function g(a,b,c){angular.element(a.target).is("a, button, input[type=button]")&&(a.preventDefault(),b.callback(c))}function h(){_.each(c.cols,function(a){a.filter=""})}if(c.vm={sortAsc:!1,sort:_.findIndex(c.cols,{sortable:!0}),currentPage:1,pageSize:c.pageSize?c.pageSize:25,showAdvanced:!1,filterText:"",toggleSort:e,onClick:g,onEnter:f,clearFilters:h,extend:function(a){return _.extend({},d.parent().scope(),a)}},c.cols)for(var i="",j=0;j<c.cols.length;j++)"function"!=typeof c.cols[j].template&&(i=c.cols[j].template?c.cols[j].template:c.cols[j].key?"{{"+c.cols[j].key+"}}":"",c.cols[j].template=a(i))}}}a.$inject=["$interpolate","$timeout"],angular.module("sds-angular-controls").directive("clientGrid",a)}(),function(){"use strict";function a(a){return function(b,c){if("string"==typeof c)return a("filter")(b,c);var d=function(a,b){for(var c=b.split(".");c.length&&(a=a[c.shift()]););return a},e=[];return _.each(c,function(a){if("date"===a.type&&a.filter){var b=a.filter.split("-"),c=moment(b[0]),d=moment(b[1]||c.clone().endOf("day"));c.isValid()&&d.isValid()&&e.push({filter:[c.valueOf(),d.valueOf()],key:a.key,type:a.type})}else if("number"===a.type&&a.filter){var f=a.filter.split("-");!f[0]&&f[1]&&(f.slice(0,1),f[0]*=-1),!f[1]&&f[2]&&(f.slice(1,1),f[1]*=-1);var g=parseFloat(f[0]),h=parseFloat(f[1]||f[0]);e.push({filter:[g,h],key:a.key,type:a.type})}else"string"==typeof a.filter&&e.push({filter:a.filter.toLowerCase(),key:a.key})}),_.filter(b,function(a){return _.all(e,function(b){if(!b.filter||!b.key)return!0;if(!b.type)return(d(a,b.key)+"").toLowerCase().indexOf(b.filter)>-1;if("date"===b.type){var c=moment(d(a,b.key)).valueOf();return c>=b.filter[0]&&c<=b.filter[1]}return"number"===b.type?d(a,b.key)>=b.filter[0]&&d(a,b.key)<=b.filter[1]:void 0})})}}a.$inject=["$filter"],angular.module("sds-angular-controls").filter("complexFilter",a)}(),function(){"use strict";function a(a,b){return{restrict:"EA",templateUrl:"sds-angular-controls/form-field.html",scope:{record:"=",field:"@",toggleField:"@?",rightLabel:"@",items:"=?",placeholder:"@",max:"@?",min:"@",type:"@",fieldType:"@",onLabel:"@",offLabel:"@",toggleSwitchType:"@",mask:"@",label:"@",isRequired:"=?",layout:"@",labelLayoutCss:"@",inputLayoutCss:"@",errorLayoutCss:"@",hideValidationMessage:"=?",disableTimepicker:"=?",showLabel:"=?",dateFormat:"@",isReadonly:"=?",style:"@?"},require:"^form",link:function(c,d,e,f){function g(){if(c.isReadonly&&c.record&&c.record[c.field]){if("select"===c.fieldType){var a=c.items[c.record[c.field]];c.readOnlyModel=a}"toggle"===c.fieldType&&(c.readOnlyModel=c.record[c.field]),"quickdatepicker"===c.fieldType&&(c.readOnlyModel=moment(c.record[c.field]).format(c.dateFormat))}}c.calender={opened:!1},c.types=a,c.fieldType=c.fieldType||"input",c.isReadonly=c.isReadonly||!1,c.layout=c.layout||"stacked",c.isRequired=c.isRequired||!1,c.showLabel=c.showLabel||!0,c.hideValidationMessage=c.hideValidationMessage||!1,"inline"===c.layout&&(c.labelLayoutCss=c.labelLayoutCss||"col-md-4",c.inputLayoutCss=c.inputLayoutCss||"col-md-6",c.errorLayoutCss=c.errorLayoutCss||"col-md-4"),c.toggleSwitchType=c.toggleSwitchType||"primary",c.onLabel=c.onLabel||"Yes",c.offLabel=c.offLabel||"No",c.disableTimepicker=c.disableTimepicker||!1,c.dateFormat=c.dateFormat||"MM-dd-yyyy",c.label||(c.label=b("labelCase")(c.field));var h=d.find(".inputField");c.orderHash=function(a){return a?a.orderedKeys||Object.keys(a):[]},c.convertType=function(a){return c.record&&c.record[c.field]&&"string"==typeof c.record[c.field]?a.toString():a&&!isNaN(parseInt(a,10))?parseInt(a,10):a},c.$watch("isReadonly",function(a,b){a!==b&&g()}),c.$watch("record",function(a,b){a!==b&&g()}),c.mask&&h.mask(c.mask),c.open=function(a){a.preventDefault(),a.stopPropagation(),c.calender.opened=!0},c.showError=function(a){try{return f.$submitted?a.$invalid:a.$dirty&&a.$invalid}catch(b){return!1}}}}}a.$inject=["InputTypes","$filter","$log"],angular.module("sds-angular-controls").value("InputTypes",{text:["Text","should be text"],email:["Email","should be an email address"],number:["Number","should be a number"],date:["Date","should be a date"],datetime:["Datetime","should be a datetime"],time:["Time","should be a time"],month:["Month","should be a month"],week:["Week","should be a week"],url:["URL","should be a URL"],tel:["Phone Number","should be a phone number"],color:["Color","should be a color"]}).directive("formField",a)}(),function(){"use strict";function a(){return function(a,b){var c={};return angular.forEach(a,function(a,d){d!==b&&(c[d]=a)}),c}}angular.module("sds-angular-controls").filter("keyFilter",a)}(),function(){"use strict";function a(){return function(a){return a=a.replace(/([A-Z])/g," $1"),a[0].toUpperCase()+a.slice(1)}}angular.module("sds-angular-controls").filter("labelCase",a)}(),function(){"use strict";function a(){return{restrict:"A",scope:{maskInput:"@"},link:function(a,b){$(b).mask(a.maskInput)}}}angular.module("sds-angular-controls").directive("maskInput",a)}(),function(){"use strict";function a(){return{restrict:"A",link:function(a,b,c){b.bind("keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.onEnter)}),b.preventDefault())})}}}angular.module("sds-angular-controls").directive("onEnter",a)}(),function(){"use strict";function a(){var a=["th","st","nd","rd"];return function(b){var c=b%100;return b+(a[(c-20)%10]||a[c]||a[0])}}angular.module("sds-angular-controls").filter("ordinal",a)}(),function(){"use strict";function a(){return function(a,b,c){return a&&a.length?(b=parseInt(b||0,10)||0,c=parseInt(c||0,10),c||(c=25),a.slice(b*c,(b+1)*c)):[]}}angular.module("sds-angular-controls").filter("page",a)}(),function(){"use strict";function a(){return function(a){if(!a)return"";var b=a.toString().trim().replace(/^\+/,"");if(b.match(/[^0-9]/))return a;var c,d,e;switch(b.length){case 10:c=1,d=b.slice(0,3),e=b.slice(3);break;case 11:c=b[0],d=b.slice(1,4),e=b.slice(4);break;case 12:c=b.slice(0,3),d=b.slice(3,5),e=b.slice(5);break;default:return a}return 1===c&&(c=""),e=e.slice(0,3)+"-"+e.slice(3),(c+" ("+d+") "+e).trim()}}angular.module("sds-angular-controls").filter("phoneNumber",a)}(),angular.module("sds-angular-controls").run(["$templateCache",function(a){"use strict";a.put("sds-angular-controls/client-grid.html",'<div class="table-responsive"> <div class="btn-toolbar"> <a ng-if="vm.showAdvanced" href="" class="btn btn-default" ng-click="vm.clearFilters()">Clear All Filters <span class="big-x">&times;</span></a> <div ng-if="!vm.showAdvanced" class="toolbar-input"> <div class="form-group has-feedback"> <input class="form-control" type="text" ng-model="vm.filterText" placeholder="Filter {{label || \'items\'}}" on-enter="vm.onEnter()"> <a href="" ng-click="vm.filterText = \'\'" class="form-control-feedback feedback-link">&times;</a> </div> </div> <a href="" ng-if="!hideAdvanced" class="btn btn-default" ng-class="{active: vm.showAdvanced}" ng-click="vm.showAdvanced = !vm.showAdvanced">Advanced Filtering</a> <ng-transclude></ng-transclude> <p ng-show="data"><i>{{vm.resultCount.length}} {{label || \'items\'}}</i></p> </div> <table class="table table-hover {{className}}"> <thead> <tr> <th ng-repeat="col in cols"> <div ng-if="vm.showAdvanced && col.sortable"> <input type="text" class="form-control filter-input" on-enter="vm.onEnter()" ng-model="col.filter" placeholder="Filter {{col.name}}" tooltip="{{col.type ? \'Use a dash (-) to specify a range\' : \'\'}}" tooltip-trigger="focus" tooltip-placement="top"> </div> <a href="" ng-if="col.sortable" ng-click="vm.toggleSort($index)">{{::col.name}} <i class="fa" ng-class="{\n                     \'fa-sort\'     : vm.sort !== $index,\n                     \'fa-sort-down\': vm.sort === $index &&  vm.sortAsc,\n                     \'fa-sort-up\'  : vm.sort === $index && !vm.sortAsc\n                     }"></i> </a> <span ng-if="!col.sortable"> {{::col.name}} </span>    <tbody> <tr ng-repeat="row in (vm.resultCount = (data | complexFilter : (vm.showAdvanced ? cols : vm.filterText)))\n                                                      | orderBy       : cols[vm.sort].key       : vm.sortAsc\n                                                      | page          : (vm.currentPage - 1)    : vm.pageSize"> <td ng-repeat-start="col in cols" ng-if="col.callback && !col.fieldType" ng-click="vm.onClick($event, col, row)" ng-bind-html="::col.template(vm.extend(row)) | unsafe">  <td ng-if="!col.callback && !col.fieldType" ng-bind-html="::col.template(vm.extend(row)) | unsafe">  <td ng-repeat-end ng-if="col.fieldType"> <form-field layout="grid" record="row" items="col.items" field="{{col.key}}" type="{{col.type}}" mask="{{col.mask}}" on-label="{{col.onLabel}}" off-label="{{col.offLabel}}" is-required="col.isRequired" field-type="{{col.fieldType}}" date-format="{{col.dateFormat}}" input-layout-css="{{col.inputLayoutCss}}" disable-timepicker="col.disableTimepicker" toggle-switch-type="{{col.toggleSwitchType}}"></form-field>    </table> <pagination ng-if="vm.resultCount.length > vm.pageSize" total-items="vm.resultCount.length" items-per-page="vm.pageSize" ng-model="vm.currentPage"></pagination> </div>'),a.put("sds-angular-controls/form-field-controls.html",'<!-- input --> <div ng-if="::fieldType === \'input\'"> <input ng-readonly="isReadonly" style="{{::style}}" class="form-control inputField {{::inputLayoutCss}}" ng-model="record[field]" type="{{::type}}" mask-input="{{::mask}}" ng-required="isRequired" max="{{::max}}" min="{{::min}}"> <div ng-if="::(rightLabel && rightLabel.length > 0)" class="rightLabel">{{::rightLabel}}</div> </div> <!-- numeric --> <input ng-if="::fieldType === \'autonumeric\'" style="{{::style}}" ng-readonly="isReadonly" type="text" auto-numeric class="form-control inputField {{::inputLayoutCss}}" ng-model="record[field]" max="{{::max}}" min="{{::min}}" ng-required="isRequired"> <!-- textarea --> <textarea ng-if="::fieldType == \'textarea\'" ng-readonly="isReadonly" class="form-control fullscreen inputField {{::inputLayoutCss}}" ng-model="record[field]" type="{{::type}}" style="{{::style}}" ng-required="isRequired"></textarea> <!-- toggle --> <div ng-if="::fieldType === \'toggle\'"> <toggle-switch style="{{::style}}" class="{{::toggleSwitchType}}" ng-model="record[field]" on-label="{{::onLabel}}" off-label="{{::offLabel}}"> </toggle-switch> <!--<input ng-if="isReadonly" style="{{::style}}" ng-readonly="isReadonly" type=\'text\'--> <!--class="form-control inputField {{::inputLayoutCss}}" ng-model=\'readOnlyModel\'/>--> <div ng-if="isReadonly" class="rightLabel">{{record[field] ? onLabel : offLabel}}</div> </div> <!-- texttoggle --> <div ng-if="::fieldType === \'texttoggle\'" class="{{::inputLayoutCss}} text-toggle"> <input type="text" style="{{::style}}" ng-readonly="isReadonly" type="{{::type}}" class="form-control inputField" ng-model="record[field]"> <toggle-switch ng-if="!isReadonly" class="{{::toggleSwitchType}}" ng-model="record[toggleField]" on-label="{{::onLabel}}" off-label="{{::offLabel}}"> </toggle-switch> <div ng-if="isReadonly" class="rightLabel">{{record[field] ? onLabel : offLabel}}</div> </div> <div ng-if="::fieldType === \'select\'"> <select ng-if="!isReadonly && !hasFilter" ng-readonly="isReadonly" class="form-control" name="{{::field}}" ng-model="record[field]" ng-options="convertType(key) as items[key] for key in orderHash(items)" ng-required="isRequired"></select> <!-- optionValue as optionLabel for arrayItem in array --> <input ng-if="isReadonly" style="{{::style}}" ng-readonly="isReadonly" type="text" class="form-control inputField {{::inputLayoutCss}}" ng-model="readOnlyModel"> </div> <!-- quickdatapicker --> <span class="input-group" ng-if="::fieldType === \'quickdatepicker\'"> <input type="text" style="{{::style}}" class="form-control datepicker ng-if=" isreadonly ng-readonly="isReadonly" placeholder="{{placeholder}}" ng-model="record[field]" ng-required="::isRequired" min-date="::min" max-date="::max" datepicker-popup="{{::dateFormat}}" is-open="calender.opened"> <span ng-if="!isReadonly" class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button> </span> </span>'),a.put("sds-angular-controls/form-field.html",'<div> <div ng-if="layout === \'stacked\'" class="form-group clearfix" ng-form="{{field}}" ng-class="{ \'has-error\': showError({{field}}) }"> <label ng-if="showLabel" class="control-label {{labelLayoutCss}}"> {{ label }} <span ng-if="isRequired && !isReadonly">*</span></label> <div class="clearfix"> <ng-include src="\'sds-angular-controls/form-field-controls.html\'"></ng-include> </div> <!-- validation --> <div ng-if="!hideValidationMessage" class="pull-left has-error" ng-show="showError({{field}})" ng-messages="{{field}}.$error"> <span class="control-label" ng-message="required"> {{ field | labelCase }} is required. </span> <span class="control-label" ng-message="min"> {{ field | labelCase }} must be at least {{min}}. </span> <span class="control-label" ng-message="max"> {{ field | labelCase }} must not exceed {{max}} </span> <span class="control-label" ng-repeat="(k, v) in types" ng-message="{{k}}"> {{ field | labelCase }}{{v[1]}}</span> </div> </div> <div ng-if="layout === \'inline\'" class="form-group clearfix" ng-form="{{field}}" ng-class="{ \'has-error\': showError({{field}}) }"> <label ng-if="showLabel" class="control-label {{labelLayoutCss}}"> {{ label }} <span ng-if="isRequired && !isReadonly">*</span></label> <div class="{{inputLayoutCss}}"> <ng-include src="\'directive/formField/form-field-controls.html\'"></ng-include> </div> <div ng-if="!hideValidationMessage" ng-show="showError({{field}})" class="popover right alert-danger" style="display:inline-block; top:auto; left:auto; margin-top:-6px; min-width:240px"> <div class="arrow" style="top: 50%"></div> <div class="popover-content" ng-messages="{{field}}.$error"> <div ng-message="required"> {{ field | labelCase }} is required. </div> <div ng-message="min"> {{ field | labelCase }} must be at least {{min}}. </div> <div ng-message="max"> {{ field | labelCase }} must not exceed {{max}} </div> <div ng-repeat="(k, v) in types" ng-message="{{k}}"> {{ field | labelCase }} {{v[1]}}</div> </div> </div> <!----> <!--<div ng-if="!hideValidationMessage" class=\'{{errorLayoutCss}} has-error\'--> <!--ng-show=\'showError({{field}})\' ng-messages=\'{{field}}.$error\'>--> <!--<p class=\'control-label\' ng-message=\'required\'> {{ field | labelCase }} is required. </p>--> <!--<p class=\'control-label\' ng-message=\'min\'> {{ field | labelCase }} must be at least {{min}}. </p>--> <!--<p class=\'control-label\' ng-message=\'max\'> {{ field | labelCase }} must not exceed {{max}} </p>--> <!--<p class=\'control-label\' ng-repeat=\'(k, v) in types\' ng-message=\'{{k}}\'> {{ field | labelCase }}--> <!--{{v[1]}}</p>--> <!--</div>--> </div> <ng-include ng-if="layout === \'grid\'" src="\'directive/formField/form-field-controls.html\'"></ng-include> </div>')}]),function(){"use strict";function a(a){return a.trustAsHtml}a.$inject=["$sce"],angular.module("sds-angular-controls").filter("unsafe",a)}();